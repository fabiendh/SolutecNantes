<div class="accordion-headers-align container"></div>

<mat-progress-spinner
  *ngIf="isLoadingResults"
  class="loading"
  color="basic"
  mode="indeterminate"
  diameter="100"
  value="50"
>
</mat-progress-spinner>
<app-error *ngIf="error" [error]="errorMessage"></app-error>

<span *ngIf="!isLoadingResults && !error">
  <div class="btn-toolbar justify-content-between toolbar" role="toolbar">
    <div class="btn-group" role="group">
      <div class="toolbar-title">
        <form [formGroup]="form" novalidate class="form">
          <mat-form-field class="form-full-width">
            <mat-label>Trigramme</mat-label>
            <input matInput />
          </mat-form-field>
          <br />
          <mat-form-field class="form-full-width">
            <mat-label>Nom de l'entité de formation</mat-label>
            <input matInput />
          </mat-form-field>
        </form>
      </div>
    </div>
    <div class="input-group" *ngIf="!new">
      <div class="input-group-prepend">
        <button
          mat-raised-button
          color="primary"
          class="toolbar-button"
          (click)="openDeleteDialog()"
        >
          <mat-icon>delete</mat-icon>
          Supprimer
        </button>
      </div>
    </div>
  </div>

  <mat-tab-group mat-stretch-tabs class="mat-elevation-z2">
    <!-- Tab : Informations générales -->
    <mat-tab label="Informations générales">
      <form [formGroup]="form" novalidate class="form">
        <mat-accordion>
          <!-- Accordion : Formations -->
          <mat-expansion-panel
            [expanded]="step === 0"
            (opened)="setStep(0)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Formations
              </mat-panel-title>
              <mat-panel-description>
                <!-- Etudes, Diplômes... -->
                <mat-icon>school</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>

            <mat-grid-list cols="2" rowHeight="{{ 3 * 90 }}px">
              <mat-grid-tile>
                <mat-card id="card" style="text-align: center;">
                  <mat-card-content>
                    <mat-form-field class="form-full-width">
                      <mat-label>Diplôme</mat-label>
                      <input matInput />
                    </mat-form-field>
                    <br />
                    <mat-form-field class="form-full-width">
                      <mat-label>Etablissement</mat-label>
                      <input matInput />
                    </mat-form-field>
                    <br />
                    <mat-form-field class="form-full-width">
                      <mat-label>Ville</mat-label>
                      <input matInput />
                    </mat-form-field>
                  </mat-card-content>
                </mat-card>
              </mat-grid-tile>
              <mat-grid-tile>
                <button mat-fab color="primary">
                  <mat-icon>add</mat-icon>
                </button>
              </mat-grid-tile>
            </mat-grid-list>

            <mat-action-row>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>
          <!-- End Accordion -->

          <!-- Accordion : Certifications -->
          <mat-expansion-panel
            [expanded]="step === 1"
            (opened)="setStep(1)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Certifications
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-form-field class="form-full-width">
              <mat-label>Certification</mat-label>
              <input matInput />
            </mat-form-field>
            <br />
            <button mat-fab color="primary">
              <mat-icon>add</mat-icon>
            </button>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>
          <!-- End Accordion -->

          <!-- Accordion : Qualités humaines -->
          <mat-expansion-panel
            [expanded]="step === 2"
            (opened)="setStep(2)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Qualités humaines
              </mat-panel-title>
              <mat-panel-description>
                Points forts à mettre en avant
                <!-- <mat-icon>thumb_up_alt> -->
              </mat-panel-description>
            </mat-expansion-panel-header>
            <mat-form-field class="form-full-width">
              <mat-label>Atout</mat-label>
              <input matInput />
            </mat-form-field>
            <br />
            <button mat-fab color="primary">
              <mat-icon>add</mat-icon>
            </button>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>
          <!-- End Accordion -->

          <!-- Accordion : Disponibilité -->
          <mat-expansion-panel
            [expanded]="step === 3"
            (opened)="setStep(3)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Disponibilité
              </mat-panel-title>
              <mat-panel-description>
                <!-- Points forts à mettre en avant -->
                <mat-icon>event_available</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>

            <mat-datepicker #dispo_date></mat-datepicker>
            <mat-form-field class="form-full-width">
              <mat-label>Date de disponibilité</mat-label>
              <input
                matInput
                [matDatepicker]="dispo_date"
                (focus)="dispo_date.open()"
                readonly
              />
            </mat-form-field>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Fin
              </button>
            </mat-action-row>
          </mat-expansion-panel>
        </mat-accordion>
      </form>
    </mat-tab>
    <!-- End Tab -->

    <!-- Tab Compétences -->
    <mat-tab label="Compétences">
      <form [formGroup]="form" novalidate class="form">
        <mat-accordion>
          <!-- Accordion : Certifications -->
          <mat-expansion-panel
            [expanded]="step === 4"
            (opened)="setStep(4)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Fonctionnelles
              </mat-panel-title>
            </mat-expansion-panel-header>
            <mat-form-field class="chip-list">
              <mat-chip-list #chipList aria-label="skill selection">
                <mat-chip
                  *ngFor="let skill of skills"
                  [selectable]="selectable"
                  [removable]="removable"
                  (removed)="remove(skill)"
                >
                  {{ skill }}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input
                  placeholder="Nouvelle compétence..."
                  #skillInput
                  [formControl]="skillCtrl"
                  [matAutocomplete]="auto"
                  [matChipInputFor]="chipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="add($event)"
                />
              </mat-chip-list>
              <mat-autocomplete
                #auto="matAutocomplete"
                (optionSelected)="selected($event)"
              >
                <mat-option
                  *ngFor="let skill of filteredSkills | async"
                  [value]="skill"
                >
                  {{ skill }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-action-row>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>

          <mat-expansion-panel
            [expanded]="step === 5"
            (opened)="setStep(5)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Techniques
              </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-form-field class="chip-list">
              <mat-chip-list #chipList aria-label="skill selection">
                <mat-chip
                  *ngFor="let skill of skills"
                  [selectable]="selectable"
                  [removable]="removable"
                  (removed)="remove(skill)"
                >
                  {{ skill }}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input
                  placeholder="Nouvelle compétence..."
                  #skillInput
                  [formControl]="skillCtrl"
                  [matAutocomplete]="auto"
                  [matChipInputFor]="chipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="add($event)"
                />
              </mat-chip-list>
              <mat-autocomplete
                #auto="matAutocomplete"
                (optionSelected)="selected($event)"
              >
                <mat-option
                  *ngFor="let skill of filteredSkills | async"
                  [value]="skill"
                >
                  {{ skill }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>

          <mat-expansion-panel
            [expanded]="step === 6"
            (opened)="setStep(6)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Opérationnelles
              </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-form-field class="chip-list">
              <mat-chip-list #chipList aria-label="skill selection">
                <mat-chip
                  *ngFor="let skill of skills"
                  [selectable]="selectable"
                  [removable]="removable"
                  (removed)="remove(skill)"
                >
                  {{ skill }}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input
                  placeholder="Nouvelle compétence..."
                  #skillInput
                  [formControl]="skillCtrl"
                  [matAutocomplete]="auto"
                  [matChipInputFor]="chipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="add($event)"
                />
              </mat-chip-list>
              <mat-autocomplete
                #auto="matAutocomplete"
                (optionSelected)="selected($event)"
              >
                <mat-option
                  *ngFor="let skill of filteredSkills | async"
                  [value]="skill"
                >
                  {{ skill }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>

          <mat-expansion-panel
            [expanded]="step === 7"
            (opened)="setStep(7)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Méthodologies
              </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-form-field class="chip-list">
              <mat-chip-list #chipList aria-label="skill selection">
                <mat-chip
                  *ngFor="let skill of skills"
                  [selectable]="selectable"
                  [removable]="removable"
                  (removed)="remove(skill)"
                >
                  {{ skill }}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input
                  placeholder="Nouvelle compétence..."
                  #skillInput
                  [formControl]="skillCtrl"
                  [matAutocomplete]="auto"
                  [matChipInputFor]="chipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="add($event)"
                />
              </mat-chip-list>
              <mat-autocomplete
                #auto="matAutocomplete"
                (optionSelected)="selected($event)"
              >
                <mat-option
                  *ngFor="let skill of filteredSkills | async"
                  [value]="skill"
                >
                  {{ skill }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Suivant
              </button>
            </mat-action-row>
          </mat-expansion-panel>

          <mat-expansion-panel
            [expanded]="step === 8"
            (opened)="setStep(8)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Outils
              </mat-panel-title>
            </mat-expansion-panel-header>

            <mat-form-field class="chip-list">
              <mat-chip-list #chipList aria-label="skill selection">
                <mat-chip
                  *ngFor="let skill of skills"
                  [selectable]="selectable"
                  [removable]="removable"
                  (removed)="remove(skill)"
                >
                  {{ skill }}
                  <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input
                  placeholder="Nouvelle compétence..."
                  #skillInput
                  [formControl]="skillCtrl"
                  [matAutocomplete]="auto"
                  [matChipInputFor]="chipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  (matChipInputTokenEnd)="add($event)"
                />
              </mat-chip-list>
              <mat-autocomplete
                #auto="matAutocomplete"
                (optionSelected)="selected($event)"
              >
                <mat-option
                  *ngFor="let skill of filteredSkills | async"
                  [value]="skill"
                >
                  {{ skill }}
                </mat-option>
              </mat-autocomplete>
            </mat-form-field>

            <mat-action-row>
              <button mat-button color="warn" (click)="prevStep()">
                Précédent
              </button>
              <button mat-button color="primary" (click)="nextStep()">
                Fin
              </button>
            </mat-action-row>
          </mat-expansion-panel>
        </mat-accordion>
      </form>
    </mat-tab>
    <!-- End Tab -->

    <!-- Tab Expériences -->
    <mat-tab label="Expériences">
      <form [formGroup]="form" novalidate class="form">
        <mat-grid-list cols="2" rowHeight="{{ 5 * 90 }}px">
          <mat-grid-tile>
            <mat-card id="card" style="text-align: center;">
              <mat-card-content>
                <div>
                  <table class="form-full-width" cellspacing="0">
                    <tr>
                      <td>
                        <mat-datepicker #start_date></mat-datepicker>
                        <mat-form-field class="form-full-width">
                          <mat-label>Date de début</mat-label>
                          <input
                            matInput
                            [matDatepicker]="start_date"
                            (focus)="start_date.open()"
                            readonly
                          />
                        </mat-form-field>
                      </td>
                      <td>
                        <mat-datepicker #end_date></mat-datepicker>
                        <mat-form-field class="form-full-width">
                          <mat-label>Date de fin</mat-label>
                          <input
                            matInput
                            [matDatepicker]="end_date"
                            (focus)="end_date.open()"
                            readonly
                          />
                        </mat-form-field>
                      </td>
                      <td>
                        <mat-checkbox>Mission en cours</mat-checkbox>
                      </td>
                    </tr>
                  </table>

                  <table class="form-full-width" cellspacing="0">
                    <tr>
                      <td>
                        <mat-form-field class="form-full-width">
                          <mat-label>Entreprise</mat-label>
                          <input matInput />
                        </mat-form-field>
                      </td>
                      <td>
                        <mat-checkbox>Client Solutec</mat-checkbox>
                      </td>
                    </tr>
                  </table>

                  <p>
                    <mat-form-field class="form-full-width">
                      <mat-label>Poste</mat-label>
                      <input matInput />
                    </mat-form-field>
                    <mat-form-field class="form-full-width">
                      <mat-label>Contexte client</mat-label>
                      <textarea matInput></textarea>
                    </mat-form-field>
                    <mat-form-field class="form-full-width">
                      <mat-label>Contexte mission</mat-label>
                      <textarea matInput></textarea>
                    </mat-form-field>
                  </p>
                </div>
              </mat-card-content>
            </mat-card>
          </mat-grid-tile>
          <mat-grid-tile>
            <button mat-fab color="primary">
              <mat-icon>add</mat-icon>
            </button>
          </mat-grid-tile>
        </mat-grid-list>

        <mat-accordion>
          <!-- Accordion : Détails -->
          <mat-expansion-panel
            [expanded]="step === 9"
            (opened)="setStep(9)"
            hideToggle
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                Entreprise 1
              </mat-panel-title>
              <mat-panel-description>
                Projets, Activités
              </mat-panel-description>
            </mat-expansion-panel-header>

            <mat-grid-list cols="2" rowHeight="{{ 5 * 90 }}px">
              <mat-grid-tile>
                <mat-card id="card" style="text-align: center;">
                  <mat-card-content>
                    <div>
                      <p>
                        <mat-form-field class="form-full-width">
                          <mat-label>Projet</mat-label>
                          <input matInput />
                        </mat-form-field>
                        <mat-form-field class="form-full-width">
                          <mat-label>Enjeux</mat-label>
                          <input matInput />
                        </mat-form-field>
                        <mat-form-field class="form-full-width">
                          <mat-label>Taille/Composition de l'équipe</mat-label>
                          <input matInput />
                        </mat-form-field>
                        <mat-form-field class="form-full-width">
                          <mat-label>Budget</mat-label>
                          <input matInput type="number" min="1" />
                        </mat-form-field>
                      </p>
                      <div>
                        <label class="checkbox-margin">Criticité: </label>
                        <mat-radio-group [formControl]="floatLabelControl">
                          <mat-radio-button class="checkbox-margin" value="1"
                            >Mineure</mat-radio-button
                          >
                          <mat-radio-button class="checkbox-margin" value="2"
                            >Modéré</mat-radio-button
                          >
                          <mat-radio-button class="checkbox-margin" value="3"
                            >Majeur</mat-radio-button
                          >
                        </mat-radio-group>
                      </div>

                      <table class="form-full-width" cellspacing="0">
                        <tr>
                          <td>
                            <mat-form-field class="form-full-width">
                              <mat-label>Activité</mat-label>
                              <input matInput />
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="form-full-width">
                              <mat-label>Détails</mat-label>
                              <textarea matInput></textarea>
                            </mat-form-field>
                          </td>
                          <td>
                            <mat-form-field class="chip-list">
                              <mat-chip-list
                                #chipList
                                aria-label="skill selection"
                              >
                                <mat-chip
                                  *ngFor="let skill of skills"
                                  [selectable]="selectable"
                                  [removable]="removable"
                                  (removed)="remove(skill)"
                                >
                                  {{ skill }}
                                  <mat-icon matChipRemove *ngIf="removable"
                                    >cancel</mat-icon
                                  >
                                </mat-chip>
                                <input
                                  placeholder="Nouvelle compétence..."
                                  #skillInput
                                  [formControl]="skillCtrl"
                                  [matAutocomplete]="auto"
                                  [matChipInputFor]="chipList"
                                  [matChipInputSeparatorKeyCodes]="
                                    separatorKeysCodes
                                  "
                                  (matChipInputTokenEnd)="add($event)"
                                />
                              </mat-chip-list>
                              <mat-autocomplete
                                #auto="matAutocomplete"
                                (optionSelected)="selected($event)"
                              >
                                <mat-option
                                  *ngFor="let skill of filteredSkills | async"
                                  [value]="skill"
                                >
                                  {{ skill }}
                                </mat-option>
                              </mat-autocomplete>
                            </mat-form-field>
                          </td>
                        </tr>
                      </table>
                    </div>
                  </mat-card-content>
                </mat-card>
              </mat-grid-tile>

              <mat-grid-tile>
                <button mat-fab color="primary">
                  <mat-icon>add</mat-icon>
                </button>
              </mat-grid-tile>
            </mat-grid-list>
          </mat-expansion-panel>
        </mat-accordion>
      </form>
    </mat-tab>
    <!-- End Tab -->
  </mat-tab-group>

  <br />

  <div class="button-row">
    <button
      mat-raised-button
      color="primary"
      [disabled]="form.pristine || form.invalid"
    >
      <mat-icon>save</mat-icon>
      Enregistrer
    </button>
    <button
      mat-raised-button
      color="primary"
      [disabled]="form.pristine || form.invalid"
    >
      <mat-icon>cancel</mat-icon>
      Annuler
    </button>
  </div>
</span>
